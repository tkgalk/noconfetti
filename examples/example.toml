# TOML Example - Configuration File
# Testing: comments, strings, numbers, booleans, arrays, tables

# Application Configuration
title = "User Management System"

[app]
name = "User Management System"
version = "1.0.0"
api_version = "v1"
description = """
A comprehensive user management system
with role-based access control and
advanced reporting capabilities.
"""

# Server configuration
[app.server]
host = "localhost"
port = 8080
ssl = true
timeout = 30
max_connections = 1000

# TLS/SSL settings
[app.server.tls]
enabled = true
cert_file = "/path/to/cert.pem"
key_file = "/path/to/key.pem"
min_version = "1.2"
ciphers = [
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305",
]

# Database configuration
[app.database]
driver = "postgresql"
host = "localhost"
port = 5432
name = "userdb"
username = "dbuser"
password = "${DB_PASSWORD}"
ssl_mode = "require"
max_pool_size = 20
min_pool_size = 5
connection_timeout = 10
idle_timeout = 300
max_lifetime = 3600

# Redis cache configuration
[app.cache]
enabled = true
driver = "redis"
host = "localhost"
port = 6379
database = 0
password = ""
ttl = 3600
prefix = "app:"

# Logging configuration
[logging]
level = "info"
format = "json"
output = "stdout"

# Log levels by module
[logging.levels]
app = "debug"
database = "info"
http = "warn"
cache = "error"

# File logging
[logging.file]
enabled = true
path = "/var/log/app/"
name = "app.log"
max_size = 100 # MB
max_age = 30 # days
max_backups = 10
compress = true

# Authentication configuration
[auth]
enabled = true

# JWT settings
[auth.jwt]
secret = "${JWT_SECRET}"
algorithm = "HS256"
expiration = 3600 # seconds
refresh_expiration = 2592000 # 30 days
issuer = "user-management-system"
audience = "api"

# Local authentication provider
[[auth.providers]]
name = "local"
type = "credentials"
enabled = true

[auth.providers.settings]
bcrypt_cost = 12
min_password_length = 8
require_special_char = true
require_number = true
require_uppercase = true
max_login_attempts = 5
lockout_duration = 900 # seconds

# Google OAuth2 provider
[[auth.providers]]
name = "google"
type = "oauth2"
enabled = true

[auth.providers.settings]
client_id = "${GOOGLE_CLIENT_ID}"
client_secret = "${GOOGLE_CLIENT_SECRET}"
redirect_url = "https://example.com/auth/google/callback"
scopes = ["openid", "profile", "email"]

# GitHub OAuth2 provider
[[auth.providers]]
name = "github"
type = "oauth2"
enabled = false

[auth.providers.settings]
client_id = "${GITHUB_CLIENT_ID}"
client_secret = "${GITHUB_CLIENT_SECRET}"
redirect_url = "https://example.com/auth/github/callback"
scopes = ["user:email", "read:user"]

# User roles and permissions
[[roles]]
name = "admin"
description = "Administrator with full access"
permissions = ["*"]

[[roles]]
name = "user"
description = "Regular user with limited access"
permissions = [
    "user:read",
    "user:update:self",
    "post:create",
    "post:read",
    "post:update:own",
    "post:delete:own",
]

[[roles]]
name = "guest"
description = "Guest user with read-only access"
permissions = ["user:read:public", "post:read:public"]

# Email configuration
[email]
enabled = true
provider = "smtp"

[email.smtp]
host = "smtp.gmail.com"
port = 587
username = "noreply@example.com"
password = "${EMAIL_PASSWORD}"
from = "User Management System <noreply@example.com>"
use_tls = true

# Email templates
[email.templates.welcome]
subject = "Welcome to User Management System"
template_file = "templates/welcome.html"

[email.templates.password_reset]
subject = "Password Reset Request"
template_file = "templates/password_reset.html"

[email.templates.verification]
subject = "Verify Your Email"
template_file = "templates/verification.html"

# Feature flags
[features]
user_registration = true
email_verification = true
two_factor_auth = false
api_rate_limiting = true
data_export = true
advanced_search = false
real_time_notifications = true

# API rate limiting
[rate_limiting]
enabled = true
default_limit = 100
window = 60 # seconds

# Per-endpoint limits
[rate_limiting.endpoints."/api/users"]
limit = 50
window = 60

[rate_limiting.endpoints."/api/auth/login"]
limit = 5
window = 300 # 5 attempts per 5 minutes

[rate_limiting.endpoints."/api/posts"]
limit = 200
window = 60

# Monitoring and metrics
[monitoring]
enabled = true

# Prometheus metrics
[monitoring.prometheus]
enabled = true
port = 9090
path = "/metrics"

# Health check
[monitoring.health_check]
enabled = true
path = "/health"
interval = 30

# Performance monitoring
[monitoring.apm]
enabled = false
service_name = "user-management"
environment = "production"

# Sample users for testing
[[sample_users]]
id = 1
name = "Alice Johnson"
email = "alice@example.com"
age = 28
role = "admin"
active = true
created_at = 2024-01-15T10:30:00Z

[sample_users.metadata]
department = "Engineering"
location = "San Francisco"
timezone = "America/Los_Angeles"

[[sample_users]]
id = 2
name = "Bob Smith"
email = "bob@example.com"
age = 17
role = "user"
active = true
created_at = 2024-02-20T14:45:00Z

[sample_users.metadata]
department = ""
location = "New York"
timezone = "America/New_York"

[[sample_users]]
id = 3
name = "Charlie Brown"
email = "charlie@example.com"
age = 45
role = "user"
active = false
created_at = 2024-03-10T09:15:00Z

[sample_users.metadata]
department = "Marketing"
location = "London"
timezone = "Europe/London"

# Environment-specific overrides
[environments.development.app.server]
port = 3000
ssl = false

[environments.development.logging]
level = "debug"

[environments.development.database]
name = "userdb_dev"

[environments.staging.app.server]
port = 8080
ssl = true

[environments.staging.logging]
level = "info"

[environments.staging.database]
name = "userdb_staging"

[environments.production.app.server]
port = 443
ssl = true

[environments.production.logging]
level = "warn"

[environments.production.database]
name = "userdb_prod"
max_pool_size = 50

# Notification channels
[[notifications.channels]]
type = "email"
enabled = true
recipients = ["admin@example.com", "ops@example.com"]
events = ["user_created", "user_deleted", "security_alert"]

[[notifications.channels]]
type = "slack"
enabled = true
webhook_url = "${SLACK_WEBHOOK_URL}"
channel = "#alerts"
events = ["error", "critical", "security_alert"]

[[notifications.channels]]
type = "sms"
enabled = false
provider = "twilio"
from = "+1234567890"
events = ["critical"]

[notifications.channels.credentials]
account_sid = "${TWILIO_ACCOUNT_SID}"
auth_token = "${TWILIO_AUTH_TOKEN}"

# Scheduled tasks
[[scheduled_tasks]]
name = "cleanup_old_sessions"
schedule = "0 0 * * *" # Daily at midnight
enabled = true

[[scheduled_tasks]]
name = "send_daily_report"
schedule = "0 9 * * 1-5" # Weekdays at 9 AM
enabled = true
recipients = ["admin@example.com"]

[[scheduled_tasks]]
name = "backup_database"
schedule = "0 2 * * *" # Daily at 2 AM
enabled = true
retention_days = 30

# Integration configurations
[integrations.analytics.google_analytics]
enabled = true
tracking_id = "${GA_TRACKING_ID}"

[integrations.analytics.mixpanel]
enabled = false
project_token = "${MIXPANEL_TOKEN}"

[integrations.payment.stripe]
enabled = true
public_key = "${STRIPE_PUBLIC_KEY}"
secret_key = "${STRIPE_SECRET_KEY}"
webhook_secret = "${STRIPE_WEBHOOK_SECRET}"

[integrations.storage.aws_s3]
enabled = true
region = "us-west-2"
bucket = "user-uploads"
access_key_id = "${AWS_ACCESS_KEY_ID}"
secret_access_key = "${AWS_SECRET_ACCESS_KEY}"

# Legal text
[legal]
privacy_policy = """
This is a privacy policy that can span
multiple lines. TOML preserves the exact
formatting of multi-line strings.
"""

terms_of_service = """
These are the terms of service.
Line breaks are preserved exactly.

This is a new paragraph.
"""

# Special values and data types
[special_values]
boolean_true = true
boolean_false = false
integer = 42
float = 3.14159
scientific = 1.23e-4
string = "hello world"
date = 2024-01-15
datetime = 2024-01-15T10:30:00Z
datetime_with_offset = 2024-01-15T10:30:00-08:00

# Arrays of different types
[arrays]
integers = [1, 2, 3, 4, 5]
floats = [1.0, 2.5, 3.14, 4.2]
strings = ["red", "green", "blue"]
booleans = [true, false, true]
dates = [2024-01-15, 2024-02-20, 2024-03-10]

# Nested arrays
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9],
]

# Mixed type array (array of tables)
[[mixed]]
name = "item1"
value = 100

[[mixed]]
name = "item2"
value = 200

# Inline tables
[inline_tables]
point = { x = 1, y = 2, z = 3 }
color = { r = 255, g = 128, b = 0 }
user = { name = "Alice", age = 28, active = true }

# Complex nested structure
[api]
version = "1.0"
base_url = "https://api.example.com"

[api.endpoints.users]
path = "/users"
methods = ["GET", "POST"]
auth_required = true

[api.endpoints.users.rate_limit]
requests = 100
window = 60

[api.endpoints.posts]
path = "/posts"
methods = ["GET", "POST", "PUT", "DELETE"]
auth_required = true

[api.endpoints.posts.rate_limit]
requests = 200
window = 60

[api.endpoints.public]
path = "/public"
methods = ["GET"]
auth_required = false

# Dotted keys (alternative syntax)
physical.color = "orange"
physical.shape = "round"
site."google.com" = true

# Numbers with underscores for readability
[numbers]
trillion = 1_000_000_000_000
bytes = 0xFF_FF_FF
scientific_readable = 6.022_140_76e23

# Time values
[time]
milliseconds = 500
seconds = 30
minutes = 15
hours = 2
days = 7
